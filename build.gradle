import org.apache.tools.ant.filters.*

plugins {
    id 'workspace.java-application-conventions'
}

version = sharedVersion

dependencies {
    implementation project(':MCU-API')
    implementation project(':MCU-DownloadLib')
}

processResources {
    duplicatesStrategy = DuplicatesStrategy.INCLUDE
    from(sourceSets*.resources.srcDirs) {
        include '**/*.properties' filter(ReplaceTokens, tokens: [verMajor: Integer.toString(version.major), verMinor: Integer.toString(version.minor), verBuild: Integer.toString(version.buildNum)])
    }
    from(sourceSets*.resources.srcDirs) { exclude '**/*.properties' }
}

jar {
    duplicatesStrategy = DuplicatesStrategy.INCLUDE
    from configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
    manifest {
        attributes "Main-Class": 'org.mcupdater.MCUCLI'
    }
}

jar.setDependsOn([':MCU-API:jar',':MCU-DownloadLib:jar'])